@if (mode$ | async; as mode) {
  <div class="controls-panel">
    <div class="button-group">
      <button 
        [class.active]="mode === 'draw'"
        (click)="setMode('draw')">
        <span class="button-icon pencil-icon"></span>
        Draw Map
      </button>
      
      <button 
        [class.active]="mode === 'erase'"
        (click)="setMode('erase')"
        title="Erase walls and remove waypoints">
        <span class="button-icon eraser-icon"></span>
        Eraser
      </button>
      
      <button 
        [class.active]="mode === 'set_points'"
        (click)="setMode('set_points')">
        <span class="button-icon flag-icon"></span>
        Set Points
      </button>
      
      <button 
        [class.active]="mode === 'find_path'"
        (click)="findPath()"
        [disabled]="isCalculating">
        {{ isCalculating ? 'Calculating...' : 'Find Path' }}
      </button>
      
      <button 
        (click)="replayAnimation()">
        Replay
      </button>
      
      <button 
        class="clear-btn"
        (click)="clearWaypoints()">
        Clear Waypoints
      </button>
    </div>
    
    <div class="options">
      <label class="checkbox-label">
        <input 
          type="checkbox" 
          [checked]="(optimizeOrder$ | async) || false"
          (change)="toggleOptimizeOrder()">
        <span>Optimize Waypoint Order</span>
      </label>
      
      <select [disabled]="!(optimizeOrder$ | async)"
          class="strategy-select"
          [value]="(optimizationStrategy$ | async) || 'strategy1'"
          (change)="setOptimizationStrategy($event)">
          <option value="strategy1">Strategy 1 (Fast)</option>
          <option value="strategy2">Strategy 2 (Accurate)</option>
        </select>
    </div>
  </div>
}
